\doxysection{zct\+::Event\+Thread\texorpdfstring{$<$}{<} Event\+Type \texorpdfstring{$>$}{>} Class Template Reference}
\hypertarget{classzct_1_1EventThread}{}\label{classzct_1_1EventThread}\index{zct::EventThread$<$ EventType $>$@{zct::EventThread$<$ EventType $>$}}


Use this class in your objects to create a thread that can wait for events.  




{\ttfamily \#include $<$Event\+Thread.\+hpp$>$}



Collaboration diagram for zct\+::Event\+Thread\texorpdfstring{$<$}{<} Event\+Type \texorpdfstring{$>$}{>}\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=254pt]{classzct_1_1EventThread__coll__graph}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classzct_1_1EventThread_a4751223fb4a4b628988433c0f415892f}{Event\+Thread}} (const char \texorpdfstring{$\ast$}{*}name, k\+\_\+thread\+\_\+stack\+\_\+t \texorpdfstring{$\ast$}{*}thread\+Stack, size\+\_\+t thread\+Stack\+Size, int thread\+Priority, size\+\_\+t event\+Queue\+Buffer\+Num\+Items)
\item 
\mbox{\hyperlink{classzct_1_1EventThread_a904626047be03e08a6563cdafb3582c0}{\texorpdfstring{$\sim$}{\string~}\+Event\+Thread}} ()
\item 
void \mbox{\hyperlink{classzct_1_1EventThread_aab7247827f4989207fc613d8b4495219}{start}} ()
\item 
void \mbox{\hyperlink{classzct_1_1EventThread_a466b293455fda762c63357549025d8af}{on\+External\+Event}} (std\+::function$<$ void(const Event\+Type \&)$>$ callback)
\item 
void \mbox{\hyperlink{classzct_1_1EventThread_a6eda66c2494c12922204a368786dfb73}{send\+Event}} (const Event\+Type \&event)
\item 
\mbox{\hyperlink{classzct_1_1TimerManager}{Timer\+Manager}} \& \mbox{\hyperlink{classzct_1_1EventThread_aa5461d18e52c82257da77a557f173e24}{timer\+Manager}} ()
\item 
void \mbox{\hyperlink{classzct_1_1EventThread_a491f2b0619e3db842d9f40f1b268f892}{exit\+Event\+Loop}} ()
\end{DoxyCompactItemize}
\doxysubsubsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{classzct_1_1EventThread_a7edd0a4e156e57bf8f3c6832ae3bde68}{run\+Event\+Loop}} ()
\end{DoxyCompactItemize}
\doxysubsubsection*{Static Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
static void \mbox{\hyperlink{classzct_1_1EventThread_ad9ef1d2f6b589be97f8a27c632278d2b}{static\+Thread\+Function}} (void \texorpdfstring{$\ast$}{*}arg1, void \texorpdfstring{$\ast$}{*}arg2, void \texorpdfstring{$\ast$}{*}arg3)
\end{DoxyCompactItemize}
\doxysubsubsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
const char \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{classzct_1_1EventThread_a2445c0ef143d1ecece52db6354c1a3c6}{m\+\_\+name}} = nullptr
\item 
void \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{classzct_1_1EventThread_a63d260fa7951c1731953b2f89cb8c794}{m\+\_\+event\+Queue\+Buffer}} = nullptr
\item 
struct k\+\_\+thread \mbox{\hyperlink{classzct_1_1EventThread_ae99f50e4328cdd741e63e379fbe7de6a}{m\+\_\+thread}}
\item 
struct k\+\_\+msgq \mbox{\hyperlink{classzct_1_1EventThread_aeac1a315e79be599f6c6c8e275c7286a}{m\+\_\+thread\+Msg\+Queue}}
\item 
k\+\_\+thread\+\_\+stack\+\_\+t \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{classzct_1_1EventThread_afb9f2928abd9d6ec21353c13828ec800}{m\+\_\+thread\+Stack}}
\item 
size\+\_\+t \mbox{\hyperlink{classzct_1_1EventThread_a35d26c4ac62b589f1fbd63fb43e95728}{m\+\_\+thread\+Stack\+Size}}
\item 
int \mbox{\hyperlink{classzct_1_1EventThread_a601678c8b320abfdb4670c914880556c}{m\+\_\+thread\+Priority}}
\item 
\mbox{\hyperlink{classzct_1_1TimerManager}{Timer\+Manager}} \mbox{\hyperlink{classzct_1_1EventThread_af22edf13ee45ca97df31199cdd089f7a}{m\+\_\+timer\+Manager}}
\item 
std\+::function$<$ void(const Event\+Type \&)$>$ \mbox{\hyperlink{classzct_1_1EventThread_aec687dd8872426f1aad685703922a2e0}{m\+\_\+external\+Event\+Callback}} = nullptr
\item 
bool \mbox{\hyperlink{classzct_1_1EventThread_afdfe877db96d4deef20cc96f6673c84a}{m\+\_\+exit\+Event\+Loop}} = false
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\subsubsection*{template$<$typename Event\+Type$>$\newline
class zct\+::\+Event\+Thread$<$ Event\+Type $>$}
Use this class in your objects to create a thread that can wait for events. 

This class spawns a new Zephyr thread.

The user is responsible for making sure the thread function returns if you want to destroy this object. This is because the destructor blocks until the thread is complete. The best way to do this is to implement a exit event and send it to the event thread. The event thread returns when it receives the exit event.

Making sure to return from the thread function is only important if you are destroying the object, e.\+g. in testing.

Below is an example of how to use this class.


\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ <variant>}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ <zephyr/kernel.h>}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ <zephyr/logging/log.h>}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{EventThread_8hpp}{ZephyrCppToolkit/Events/EventThread.hpp}}"{}}}
\DoxyCodeLine{}
\DoxyCodeLine{\mbox{\hyperlink{namespacezct_a03e785beb455af4012d3a57e19c99d13}{LOG\_MODULE\_REGISTER}}(EventThreadTests,\ LOG\_LEVEL\_DBG);}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//================================================================================================//}}
\DoxyCodeLine{\textcolor{comment}{//\ EVENTS}}
\DoxyCodeLine{\textcolor{comment}{//================================================================================================//}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{namespace\ }Events\ \{}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{struct\ }Exit\ \{\};}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{struct\ }LedFlashing\ \{}
\DoxyCodeLine{\ \ \ \ uint32\_t\ flashRateMs;}
\DoxyCodeLine{\};}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{struct\ }TimerExpired\ \{\};}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//\ Create\ a\ generic\ event\ type\ that\ can\ be\ anyone\ of\ the\ specific\ events\ above.}}
\DoxyCodeLine{\textcolor{keyword}{typedef}\ std::variant<LedFlashing,\ Exit,\ TimerExpired>\ Generic;}
\DoxyCodeLine{}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//================================================================================================//}}
\DoxyCodeLine{\textcolor{comment}{//\ EVENT\ THREAD}}
\DoxyCodeLine{\textcolor{comment}{//================================================================================================//}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{class\ }Led\ \{}
\DoxyCodeLine{\textcolor{keyword}{public}:}
\DoxyCodeLine{\ \ \ \ Led()\ :}
\DoxyCodeLine{\ \ \ \ \ \ \ \ m\_eventThread(}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Led"{}},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ m\_threadStack,}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ THREAD\_STACK\_SIZE,}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ 7,}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ EVENT\_QUEUE\_NUM\_ITEMS}
\DoxyCodeLine{\ \ \ \ \ \ \ \ ),}
\DoxyCodeLine{\ \ \ \ \ \ \ \ m\_flashingTimer(\textcolor{stringliteral}{"{}FlashingTimer"{}},\ [this]()\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ Events::TimerExpired\ timerExpiredEvent;}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ handleEvent(timerExpiredEvent);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \})}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{comment}{//\ Register\ timers}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ m\_eventThread.timerManager().registerTimer(m\_flashingTimer);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ }
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{comment}{//\ Register\ external\ event\ callback}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ m\_eventThread.onExternalEvent([\textcolor{keyword}{this}](\textcolor{keyword}{const}\ Events::Generic\&\ event)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ handleEvent(event);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{\ \ \ \ \ \ \ \ }
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{comment}{//\ Start\ the\ event\ loop\ (it\ runs\ it\ it's\ own\ thread)}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ m\_eventThread.start();}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \string~Led()\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{comment}{//\ Send\ the\ exit\ event\ to\ the\ event\ thread}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ Events::Exit\ exitEvent;}
\DoxyCodeLine{\ \ \ \ \ \ \ \ m\_eventThread.sendEvent(exitEvent);}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordtype}{void}\ flash(uint32\_t\ flashRateMs)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ Events::LedFlashing\ ledFlashingEvent\ =\ \{\ .flashRateMs\ =\ flashRateMs\ \};}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{comment}{//\ This\ is\ how\ use\ send\ "{}external"{}\ events\ (i.e.\ not\ timer\ events)\ to}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{comment}{//\ the\ event\ thread.\ The\ event\ thread\ will\ call\ handleEvent()\ when\ it}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{comment}{//\ receives\ this\ event.}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ m\_eventThread.sendEvent(ledFlashingEvent);}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{private}:}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{size\_t}\ EVENT\_QUEUE\_NUM\_ITEMS\ =\ 10;}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{size\_t}\ THREAD\_STACK\_SIZE\ =\ 512;}
\DoxyCodeLine{\ \ \ \ K\_KERNEL\_STACK\_MEMBER(m\_threadStack,\ THREAD\_STACK\_SIZE);}
\DoxyCodeLine{\ \ \ \ \mbox{\hyperlink{classzct_1_1EventThread}{zct::EventThread<Events::Generic>}}\ m\_eventThread;}
\DoxyCodeLine{\ \ \ \ \mbox{\hyperlink{classzct_1_1Timer}{zct::Timer}}\ m\_flashingTimer;}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordtype}{bool}\ m\_ledIsOn\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordtype}{void}\ handleEvent(\textcolor{keyword}{const}\ Events::Generic\&\ event)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (std::holds\_alternative<Events::LedFlashing>(event))\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Start\ the\ timer\ to\ flash\ the\ LED}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ m\_flashingTimer.\mbox{\hyperlink{classzct_1_1Timer_ac98b8c2905ad49b083265b9da5b8a750}{start}}(1000,\ 1000);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ LOG\_INF(\textcolor{stringliteral}{"{}Starting\ flashing.\ Turning\ LED\ on..."{}});}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ m\_ledIsOn\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (std::holds\_alternative<Events::Exit>(event))\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ This\ will\ cause\ the\ event\ loop\ to\ end\ (and\ the\ thread\ to\ exit)}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ once\ we\ return\ from\ handleEvent().}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ m\_eventThread.\mbox{\hyperlink{classzct_1_1EventThread_a491f2b0619e3db842d9f40f1b268f892}{exitEventLoop}}();}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (std::holds\_alternative<Events::TimerExpired>(event))\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ LOG\_INF(\textcolor{stringliteral}{"{}Toggling\ LED\ to\ \%d."{}},\ !m\_ledIsOn);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ m\_ledIsOn\ =\ !m\_ledIsOn;}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\};}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keywordtype}{int}\ main()\ \{}
\DoxyCodeLine{\ \ \ \ Led\ led;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ Start\ the\ LED\ flashing.\ The\ flashing\ will\ happen}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ in\ the\ LED\ event\ thread.}}
\DoxyCodeLine{\ \ \ \ led.flash(1000);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ Wait\ 2.5s.\ The\ LED\ should\ flash\ twice\ in\ this\ time.}}
\DoxyCodeLine{\ \ \ \ k\_sleep(K\_MSEC(2500));}
\DoxyCodeLine{\}}

\end{DoxyCodeInclude}
 

\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{classzct_1_1EventThread_a4751223fb4a4b628988433c0f415892f}\label{classzct_1_1EventThread_a4751223fb4a4b628988433c0f415892f} 
\index{zct::EventThread$<$ EventType $>$@{zct::EventThread$<$ EventType $>$}!EventThread@{EventThread}}
\index{EventThread@{EventThread}!zct::EventThread$<$ EventType $>$@{zct::EventThread$<$ EventType $>$}}
\doxysubsubsection{\texorpdfstring{EventThread()}{EventThread()}}
{\footnotesize\ttfamily template$<$typename Event\+Type $>$ \\
\mbox{\hyperlink{classzct_1_1EventThread}{zct\+::\+Event\+Thread}}$<$ Event\+Type $>$\+::\+Event\+Thread (\begin{DoxyParamCaption}\item[{const char \texorpdfstring{$\ast$}{*}}]{name,  }\item[{k\+\_\+thread\+\_\+stack\+\_\+t \texorpdfstring{$\ast$}{*}}]{thread\+Stack,  }\item[{size\+\_\+t}]{thread\+Stack\+Size,  }\item[{int}]{thread\+Priority,  }\item[{size\+\_\+t}]{event\+Queue\+Buffer\+Num\+Items }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

Create a new event thread.

Dynamically allocates memory for the event queue buffer. At the moment, you have to allocate the thread stack yourself and pass it in. Once Zephyr\textquotesingle{}s dynamic thread support is out of experimental (and working), hopefully we can just pass in the desired stack size.


\begin{DoxyParams}{Parameters}
{\em name} & The name of the this event thread. Used for logging purposes. The Zephyr thread name will also be set to this name. \\
\hline
{\em thread\+Stack} & The stack to use for the thread. You can use {\ttfamily K\+\_\+\+KERNEL\+\_\+\+STACK\+\_\+\+MEMBER(m\+\_\+thread\+Stack, THREAD\+\_\+\+STACK\+\_\+\+SIZE);} to declare a stack member in the parent class that encloses this event thread. \\
\hline
{\em thread\+Stack\+Size} & The size of the stack provided. \\
\hline
{\em thread\+Priority} & The priority to assign to the thread. \\
\hline
{\em event\+Queue\+Buffer\+Num\+Items} & The number of items in the event queue. \\
\hline
\end{DoxyParams}
\Hypertarget{classzct_1_1EventThread_a904626047be03e08a6563cdafb3582c0}\label{classzct_1_1EventThread_a904626047be03e08a6563cdafb3582c0} 
\index{zct::EventThread$<$ EventType $>$@{zct::EventThread$<$ EventType $>$}!````~EventThread@{\texorpdfstring{$\sim$}{\string~}EventThread}}
\index{````~EventThread@{\texorpdfstring{$\sim$}{\string~}EventThread}!zct::EventThread$<$ EventType $>$@{zct::EventThread$<$ EventType $>$}}
\doxysubsubsection{\texorpdfstring{\texorpdfstring{$\sim$}{\string~}EventThread()}{\string~EventThread()}}
{\footnotesize\ttfamily template$<$typename Event\+Type $>$ \\
\mbox{\hyperlink{classzct_1_1EventThread}{zct\+::\+Event\+Thread}}$<$ Event\+Type $>$\+::\texorpdfstring{$\sim$}{\string~}\mbox{\hyperlink{classzct_1_1EventThread}{Event\+Thread}} (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

Destroy the event thread. This will block until the thread has exited.

If you want this function to return, make sure the event loop exits. The best way to do this is to call \doxylink{classzct_1_1EventThread_a491f2b0619e3db842d9f40f1b268f892}{exit\+Event\+Loop()} from a timer callback or external event handler. 

\doxysubsection{Member Function Documentation}
\Hypertarget{classzct_1_1EventThread_a491f2b0619e3db842d9f40f1b268f892}\label{classzct_1_1EventThread_a491f2b0619e3db842d9f40f1b268f892} 
\index{zct::EventThread$<$ EventType $>$@{zct::EventThread$<$ EventType $>$}!exitEventLoop@{exitEventLoop}}
\index{exitEventLoop@{exitEventLoop}!zct::EventThread$<$ EventType $>$@{zct::EventThread$<$ EventType $>$}}
\doxysubsubsection{\texorpdfstring{exitEventLoop()}{exitEventLoop()}}
{\footnotesize\ttfamily template$<$typename Event\+Type $>$ \\
void \mbox{\hyperlink{classzct_1_1EventThread}{zct\+::\+Event\+Thread}}$<$ Event\+Type $>$\+::exit\+Event\+Loop (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

Exit the event loop. This will cause \doxylink{classzct_1_1EventThread_a7edd0a4e156e57bf8f3c6832ae3bde68}{run\+Event\+Loop()} to return. This function must be called from the event thread context (i.\+e. from a timer callback or from an external event handler).

This will make the event loop return from \doxylink{classzct_1_1EventThread_a7edd0a4e156e57bf8f3c6832ae3bde68}{run\+Event\+Loop()} as soon as the timer callback or external event handler returns.

Use this in tests to cleanly exit from the event loop and it\textquotesingle{}s corresponding thread. \Hypertarget{classzct_1_1EventThread_a466b293455fda762c63357549025d8af}\label{classzct_1_1EventThread_a466b293455fda762c63357549025d8af} 
\index{zct::EventThread$<$ EventType $>$@{zct::EventThread$<$ EventType $>$}!onExternalEvent@{onExternalEvent}}
\index{onExternalEvent@{onExternalEvent}!zct::EventThread$<$ EventType $>$@{zct::EventThread$<$ EventType $>$}}
\doxysubsubsection{\texorpdfstring{onExternalEvent()}{onExternalEvent()}}
{\footnotesize\ttfamily template$<$typename Event\+Type $>$ \\
void \mbox{\hyperlink{classzct_1_1EventThread}{zct\+::\+Event\+Thread}}$<$ Event\+Type $>$\+::on\+External\+Event (\begin{DoxyParamCaption}\item[{std\+::function$<$ void(const Event\+Type \&)$>$}]{callback }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

Set the callback function to be called when external events are received.

The callback is executed in the context of the event thread.

This function should be used to setup the external event callback before \doxylink{classzct_1_1EventThread_aab7247827f4989207fc613d8b4495219}{start()} is called to start the event loop.


\begin{DoxyParams}{Parameters}
{\em callback} & The callback function to call when an external event is received. The callback will be passed the received event. \\
\hline
\end{DoxyParams}
\Hypertarget{classzct_1_1EventThread_a7edd0a4e156e57bf8f3c6832ae3bde68}\label{classzct_1_1EventThread_a7edd0a4e156e57bf8f3c6832ae3bde68} 
\index{zct::EventThread$<$ EventType $>$@{zct::EventThread$<$ EventType $>$}!runEventLoop@{runEventLoop}}
\index{runEventLoop@{runEventLoop}!zct::EventThread$<$ EventType $>$@{zct::EventThread$<$ EventType $>$}}
\doxysubsubsection{\texorpdfstring{runEventLoop()}{runEventLoop()}}
{\footnotesize\ttfamily template$<$typename Event\+Type $>$ \\
void \mbox{\hyperlink{classzct_1_1EventThread}{zct\+::\+Event\+Thread}}$<$ Event\+Type $>$\+::run\+Event\+Loop (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [protected]}}

Start the event loop. This function never returns and should be called from the thread function that is passed in to the constructor.

This function will\+:
\begin{DoxyItemize}
\item Handle expired timers by calling their callbacks
\item Handle external events by calling the registered external event callback (call \doxylink{classzct_1_1EventThread_a466b293455fda762c63357549025d8af}{on\+External\+Event()} to register a callback).
\end{DoxyItemize}

This should be called from the thread function that is passed in to the constructor, once any initialisation you want done (e.\+g. setup some timers) has been done. \Hypertarget{classzct_1_1EventThread_a6eda66c2494c12922204a368786dfb73}\label{classzct_1_1EventThread_a6eda66c2494c12922204a368786dfb73} 
\index{zct::EventThread$<$ EventType $>$@{zct::EventThread$<$ EventType $>$}!sendEvent@{sendEvent}}
\index{sendEvent@{sendEvent}!zct::EventThread$<$ EventType $>$@{zct::EventThread$<$ EventType $>$}}
\doxysubsubsection{\texorpdfstring{sendEvent()}{sendEvent()}}
{\footnotesize\ttfamily template$<$typename Event\+Type $>$ \\
void \mbox{\hyperlink{classzct_1_1EventThread}{zct\+::\+Event\+Thread}}$<$ Event\+Type $>$\+::send\+Event (\begin{DoxyParamCaption}\item[{const Event\+Type \&}]{event }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

Send an event to this event thread. This can be called from any other thread to send an event to this event thread.

\begin{DoxyNote}{Note}
This function is thread safe. 
\end{DoxyNote}

\begin{DoxyParams}{Parameters}
{\em event} & The event to send. It is copied into the event queue so it\textquotesingle{}s lifetime only needs to be as long as this function call. \\
\hline
\end{DoxyParams}
\Hypertarget{classzct_1_1EventThread_aab7247827f4989207fc613d8b4495219}\label{classzct_1_1EventThread_aab7247827f4989207fc613d8b4495219} 
\index{zct::EventThread$<$ EventType $>$@{zct::EventThread$<$ EventType $>$}!start@{start}}
\index{start@{start}!zct::EventThread$<$ EventType $>$@{zct::EventThread$<$ EventType $>$}}
\doxysubsubsection{\texorpdfstring{start()}{start()}}
{\footnotesize\ttfamily template$<$typename Event\+Type $>$ \\
void \mbox{\hyperlink{classzct_1_1EventThread}{zct\+::\+Event\+Thread}}$<$ Event\+Type $>$\+::start (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

Start the event thread. This creates and starts the Zephyr thread which will begin running the event loop.

This should be called after the constructor and after any setup (like registering timers) has been completed. \Hypertarget{classzct_1_1EventThread_ad9ef1d2f6b589be97f8a27c632278d2b}\label{classzct_1_1EventThread_ad9ef1d2f6b589be97f8a27c632278d2b} 
\index{zct::EventThread$<$ EventType $>$@{zct::EventThread$<$ EventType $>$}!staticThreadFunction@{staticThreadFunction}}
\index{staticThreadFunction@{staticThreadFunction}!zct::EventThread$<$ EventType $>$@{zct::EventThread$<$ EventType $>$}}
\doxysubsubsection{\texorpdfstring{staticThreadFunction()}{staticThreadFunction()}}
{\footnotesize\ttfamily template$<$typename Event\+Type $>$ \\
static void \mbox{\hyperlink{classzct_1_1EventThread}{zct\+::\+Event\+Thread}}$<$ Event\+Type $>$\+::static\+Thread\+Function (\begin{DoxyParamCaption}\item[{void \texorpdfstring{$\ast$}{*}}]{arg1,  }\item[{void \texorpdfstring{$\ast$}{*}}]{arg2,  }\item[{void \texorpdfstring{$\ast$}{*}}]{arg3 }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}, {\ttfamily [protected]}}

The function needed by pass to Zephyr\textquotesingle{}s thread API \Hypertarget{classzct_1_1EventThread_aa5461d18e52c82257da77a557f173e24}\label{classzct_1_1EventThread_aa5461d18e52c82257da77a557f173e24} 
\index{zct::EventThread$<$ EventType $>$@{zct::EventThread$<$ EventType $>$}!timerManager@{timerManager}}
\index{timerManager@{timerManager}!zct::EventThread$<$ EventType $>$@{zct::EventThread$<$ EventType $>$}}
\doxysubsubsection{\texorpdfstring{timerManager()}{timerManager()}}
{\footnotesize\ttfamily template$<$typename Event\+Type $>$ \\
\mbox{\hyperlink{classzct_1_1TimerManager}{Timer\+Manager}} \& \mbox{\hyperlink{classzct_1_1EventThread}{zct\+::\+Event\+Thread}}$<$ Event\+Type $>$\+::timer\+Manager (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

Call to get the timer manager for this event thread. This is useful when you want to create timers and then register them with the event thread.

Typically you would call\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{myEventThread.timerManager().registerTimer(myTimer);}

\end{DoxyCode}


\begin{DoxyReturn}{Returns}
A reference to the timer manager for this event thread. 
\end{DoxyReturn}


\doxysubsection{Member Data Documentation}
\Hypertarget{classzct_1_1EventThread_a63d260fa7951c1731953b2f89cb8c794}\label{classzct_1_1EventThread_a63d260fa7951c1731953b2f89cb8c794} 
\index{zct::EventThread$<$ EventType $>$@{zct::EventThread$<$ EventType $>$}!m\_eventQueueBuffer@{m\_eventQueueBuffer}}
\index{m\_eventQueueBuffer@{m\_eventQueueBuffer}!zct::EventThread$<$ EventType $>$@{zct::EventThread$<$ EventType $>$}}
\doxysubsubsection{\texorpdfstring{m\_eventQueueBuffer}{m\_eventQueueBuffer}}
{\footnotesize\ttfamily template$<$typename Event\+Type $>$ \\
void\texorpdfstring{$\ast$}{*} \mbox{\hyperlink{classzct_1_1EventThread}{zct\+::\+Event\+Thread}}$<$ Event\+Type $>$\+::m\+\_\+event\+Queue\+Buffer = nullptr\hspace{0.3cm}{\ttfamily [protected]}}

\Hypertarget{classzct_1_1EventThread_afdfe877db96d4deef20cc96f6673c84a}\label{classzct_1_1EventThread_afdfe877db96d4deef20cc96f6673c84a} 
\index{zct::EventThread$<$ EventType $>$@{zct::EventThread$<$ EventType $>$}!m\_exitEventLoop@{m\_exitEventLoop}}
\index{m\_exitEventLoop@{m\_exitEventLoop}!zct::EventThread$<$ EventType $>$@{zct::EventThread$<$ EventType $>$}}
\doxysubsubsection{\texorpdfstring{m\_exitEventLoop}{m\_exitEventLoop}}
{\footnotesize\ttfamily template$<$typename Event\+Type $>$ \\
bool \mbox{\hyperlink{classzct_1_1EventThread}{zct\+::\+Event\+Thread}}$<$ Event\+Type $>$\+::m\+\_\+exit\+Event\+Loop = false\hspace{0.3cm}{\ttfamily [protected]}}

Used to signal from \doxylink{classzct_1_1EventThread_a491f2b0619e3db842d9f40f1b268f892}{exit\+Event\+Loop()} to the code in the \doxylink{classzct_1_1EventThread_a7edd0a4e156e57bf8f3c6832ae3bde68}{run\+Event\+Loop()} function to exit. \Hypertarget{classzct_1_1EventThread_aec687dd8872426f1aad685703922a2e0}\label{classzct_1_1EventThread_aec687dd8872426f1aad685703922a2e0} 
\index{zct::EventThread$<$ EventType $>$@{zct::EventThread$<$ EventType $>$}!m\_externalEventCallback@{m\_externalEventCallback}}
\index{m\_externalEventCallback@{m\_externalEventCallback}!zct::EventThread$<$ EventType $>$@{zct::EventThread$<$ EventType $>$}}
\doxysubsubsection{\texorpdfstring{m\_externalEventCallback}{m\_externalEventCallback}}
{\footnotesize\ttfamily template$<$typename Event\+Type $>$ \\
std\+::function$<$void(const Event\+Type\&)$>$ \mbox{\hyperlink{classzct_1_1EventThread}{zct\+::\+Event\+Thread}}$<$ Event\+Type $>$\+::m\+\_\+external\+Event\+Callback = nullptr\hspace{0.3cm}{\ttfamily [protected]}}

\Hypertarget{classzct_1_1EventThread_a2445c0ef143d1ecece52db6354c1a3c6}\label{classzct_1_1EventThread_a2445c0ef143d1ecece52db6354c1a3c6} 
\index{zct::EventThread$<$ EventType $>$@{zct::EventThread$<$ EventType $>$}!m\_name@{m\_name}}
\index{m\_name@{m\_name}!zct::EventThread$<$ EventType $>$@{zct::EventThread$<$ EventType $>$}}
\doxysubsubsection{\texorpdfstring{m\_name}{m\_name}}
{\footnotesize\ttfamily template$<$typename Event\+Type $>$ \\
const char\texorpdfstring{$\ast$}{*} \mbox{\hyperlink{classzct_1_1EventThread}{zct\+::\+Event\+Thread}}$<$ Event\+Type $>$\+::m\+\_\+name = nullptr\hspace{0.3cm}{\ttfamily [protected]}}

\Hypertarget{classzct_1_1EventThread_ae99f50e4328cdd741e63e379fbe7de6a}\label{classzct_1_1EventThread_ae99f50e4328cdd741e63e379fbe7de6a} 
\index{zct::EventThread$<$ EventType $>$@{zct::EventThread$<$ EventType $>$}!m\_thread@{m\_thread}}
\index{m\_thread@{m\_thread}!zct::EventThread$<$ EventType $>$@{zct::EventThread$<$ EventType $>$}}
\doxysubsubsection{\texorpdfstring{m\_thread}{m\_thread}}
{\footnotesize\ttfamily template$<$typename Event\+Type $>$ \\
struct k\+\_\+thread \mbox{\hyperlink{classzct_1_1EventThread}{zct\+::\+Event\+Thread}}$<$ Event\+Type $>$\+::m\+\_\+thread\hspace{0.3cm}{\ttfamily [protected]}}

\Hypertarget{classzct_1_1EventThread_aeac1a315e79be599f6c6c8e275c7286a}\label{classzct_1_1EventThread_aeac1a315e79be599f6c6c8e275c7286a} 
\index{zct::EventThread$<$ EventType $>$@{zct::EventThread$<$ EventType $>$}!m\_threadMsgQueue@{m\_threadMsgQueue}}
\index{m\_threadMsgQueue@{m\_threadMsgQueue}!zct::EventThread$<$ EventType $>$@{zct::EventThread$<$ EventType $>$}}
\doxysubsubsection{\texorpdfstring{m\_threadMsgQueue}{m\_threadMsgQueue}}
{\footnotesize\ttfamily template$<$typename Event\+Type $>$ \\
struct k\+\_\+msgq \mbox{\hyperlink{classzct_1_1EventThread}{zct\+::\+Event\+Thread}}$<$ Event\+Type $>$\+::m\+\_\+thread\+Msg\+Queue\hspace{0.3cm}{\ttfamily [protected]}}

\Hypertarget{classzct_1_1EventThread_a601678c8b320abfdb4670c914880556c}\label{classzct_1_1EventThread_a601678c8b320abfdb4670c914880556c} 
\index{zct::EventThread$<$ EventType $>$@{zct::EventThread$<$ EventType $>$}!m\_threadPriority@{m\_threadPriority}}
\index{m\_threadPriority@{m\_threadPriority}!zct::EventThread$<$ EventType $>$@{zct::EventThread$<$ EventType $>$}}
\doxysubsubsection{\texorpdfstring{m\_threadPriority}{m\_threadPriority}}
{\footnotesize\ttfamily template$<$typename Event\+Type $>$ \\
int \mbox{\hyperlink{classzct_1_1EventThread}{zct\+::\+Event\+Thread}}$<$ Event\+Type $>$\+::m\+\_\+thread\+Priority\hspace{0.3cm}{\ttfamily [protected]}}

\Hypertarget{classzct_1_1EventThread_afb9f2928abd9d6ec21353c13828ec800}\label{classzct_1_1EventThread_afb9f2928abd9d6ec21353c13828ec800} 
\index{zct::EventThread$<$ EventType $>$@{zct::EventThread$<$ EventType $>$}!m\_threadStack@{m\_threadStack}}
\index{m\_threadStack@{m\_threadStack}!zct::EventThread$<$ EventType $>$@{zct::EventThread$<$ EventType $>$}}
\doxysubsubsection{\texorpdfstring{m\_threadStack}{m\_threadStack}}
{\footnotesize\ttfamily template$<$typename Event\+Type $>$ \\
k\+\_\+thread\+\_\+stack\+\_\+t\texorpdfstring{$\ast$}{*} \mbox{\hyperlink{classzct_1_1EventThread}{zct\+::\+Event\+Thread}}$<$ Event\+Type $>$\+::m\+\_\+thread\+Stack\hspace{0.3cm}{\ttfamily [protected]}}

\Hypertarget{classzct_1_1EventThread_a35d26c4ac62b589f1fbd63fb43e95728}\label{classzct_1_1EventThread_a35d26c4ac62b589f1fbd63fb43e95728} 
\index{zct::EventThread$<$ EventType $>$@{zct::EventThread$<$ EventType $>$}!m\_threadStackSize@{m\_threadStackSize}}
\index{m\_threadStackSize@{m\_threadStackSize}!zct::EventThread$<$ EventType $>$@{zct::EventThread$<$ EventType $>$}}
\doxysubsubsection{\texorpdfstring{m\_threadStackSize}{m\_threadStackSize}}
{\footnotesize\ttfamily template$<$typename Event\+Type $>$ \\
size\+\_\+t \mbox{\hyperlink{classzct_1_1EventThread}{zct\+::\+Event\+Thread}}$<$ Event\+Type $>$\+::m\+\_\+thread\+Stack\+Size\hspace{0.3cm}{\ttfamily [protected]}}

\Hypertarget{classzct_1_1EventThread_af22edf13ee45ca97df31199cdd089f7a}\label{classzct_1_1EventThread_af22edf13ee45ca97df31199cdd089f7a} 
\index{zct::EventThread$<$ EventType $>$@{zct::EventThread$<$ EventType $>$}!m\_timerManager@{m\_timerManager}}
\index{m\_timerManager@{m\_timerManager}!zct::EventThread$<$ EventType $>$@{zct::EventThread$<$ EventType $>$}}
\doxysubsubsection{\texorpdfstring{m\_timerManager}{m\_timerManager}}
{\footnotesize\ttfamily template$<$typename Event\+Type $>$ \\
\mbox{\hyperlink{classzct_1_1TimerManager}{Timer\+Manager}} \mbox{\hyperlink{classzct_1_1EventThread}{zct\+::\+Event\+Thread}}$<$ Event\+Type $>$\+::m\+\_\+timer\+Manager\hspace{0.3cm}{\ttfamily [protected]}}



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
/home/runner/work/\+Zephyr\+Cpp\+Toolkit/\+Zephyr\+Cpp\+Toolkit/include/\+Zephyr\+Cpp\+Toolkit/\+Events/\mbox{\hyperlink{EventThread_8hpp}{Event\+Thread.\+hpp}}\end{DoxyCompactItemize}
